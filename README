# microk8s installation with nginx ingress and istio gateway

Create infrastructure
  * cd tf-libvirt
  * make
  * cd ..

Then apply Ansible roles:
  * ansible-playbook playbook_microk8s.yml
  * ansible-playbook playbook_microk8s_postconfig.yml

Validate locally:
  * install k9s (https://github.com/derailed/k9s/releases)
  * export KUBECONFIG=/tmp/microk8s-kubeconfig
  * k9s

Using this ansible role for main installation:
https://github.com/istvano/ansible_role_microk8s.git

And then additional roles for:
  * k9s admin
  * getting kubeconfig to localhost
  * getting token for kubernetes dashboard
  * istio-operator installation


instead of port forwarding, you can route all traffic to internal 10.152.183.0/24 directly to the VM

# show routes
route -n
# which device routes kvm default network (last column)
route -n | grep ^192.168.122
# add route to microk8s CIDR block through VM
sudo ip route add 10.152.183.0/24 via 192.168.122.210 dev virbr0
# validate routes
route -n


