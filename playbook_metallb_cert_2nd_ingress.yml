---

- hosts: microk8s
  gather_facts: yes
  become: yes

  # most vars are coming from 'group_vars/' directory
  vars:

  # these roles only need to be applied to first node in cluster
  roles:
    - wait-for-microk8s

    # create custom CA and cert for TLS
    # certs also slurped locally to /tmp
    - cert-with-ca

    # assign MetalLB the use of the additional NIC on microk8s-1
    - metallb-service

    # microk8s 'ingress' Add-on aleady creates primary nginx ingress controller
    # https://microk8s.io/docs/addon-ingress
    # Now add a second ingress controller for use by the secondary MetalLB IP
    - add_secondary_ingress


